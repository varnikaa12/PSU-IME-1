# Line Sorter

**Project Name:** Line Sorter  
**Project Version:** `#7c7d5a3e`  
**Project URL:** https://www.flux.ai/re7rovm/line-sorter  

Line Sorter is a 24 V field I/O board that interfaces a PLC with sensors and actuators, providing protected digital inputs, low‑side MOSFET outputs for inductive loads, and a buffered analog sensor output. [file:31]

---

## 1. Overview

- **Purpose:** Condition 24 V field signals and drive multiple “line” loads (such as solenoids or relays) under PLC control. [file:31]  
- **System context:** The board sits between a PLC and field devices, converting PLC I/O into robust, protected connections for sensors and actuators. [file:31]  
- **Current status:** Rev `#7c7d5a3e` design with mapped nets and driver stages as described below. [file:31]

---

## 2. System Architecture

The Line Sorter PCB is organized into three main functional blocks: power conversion, PLC‑side I/O, and field‑side drivers/sensors. [file:31]

- **Power path:** 24 V input enters through J1, passes a fuse (F1) and protection diodes (D1, D2), and is split into 24Va and 24Vs rails with bulk and high‑frequency decoupling via C1 and C4. [file:31]  
- **DC‑DC conversion:** A TPS54302 buck regulator (U2) converts the 24Vs rail down to a 9 V rail using L1, C8, and feedback resistors R25 and R26. [file:31]  
- **Auxiliary supply:** A 5V_AUX rail is derived from the 9 V rail through an LDO regulator, powering the analog buffer op‑amp (U3) used for the color sensor signal. [file:31]  
- **PLC interface:** Digital inputs from the field are conditioned and routed into PLC input pins on U1, while PLC output pins from U1 drive the gates of MOSFET low‑side drivers. [file:31]  
- **Field connections:** Loads (e.g., solenoids) connect to J9–J13, and a color sensor connects to J15; each output or sensor line has defined return paths and protection components. [file:31]

---

## 3. Electrical Specifications

- **Input supply:** 24 V nominal via J1, protected by F1 and diodes D1/D2, generating 24Va and 24Vs rails. [file:31]  
- **Intermediate rail:** 9 V rail generated by TPS54302 buck (U2) with L1 and C8. [file:31]  
- **Auxiliary rail:** 5V_AUX derived from 9 V by an LDO to power analog circuitry (U3). [file:31]  
- **Digital inputs:** Multiple 24 V field inputs (I1, I2, I3, I5, I6, I7) feeding PLC inputs on U1 through series diodes and resistors plus pulldown resistors. [file:31]  
- **Outputs:** Five low‑side MOSFET driver channels (Q1–Q5) switching 24Va loads on connectors J9–J13, with flyback diodes for inductive loads. [file:31]

(Exact currents, voltage ranges, and derating should be filled in once the component ratings and requirements are finalized.)

---

## 4. Files and Structure

(Adjust naming to your repo/Flux export.)

- `schematic/` – Schematic source and PDF  
- `pcb/` – Layout and 3D view  
- `manufacturing/` – Gerber, drill, fabrication notes  
- `assembly/` – BOM, pick‑and‑place, assembly instructions  
- `docs/` – Additional documentation, test notes, images

---

## 5. Connectors and Pinout

Fill in exact pin numbers and names from your schematic; the notes below describe the functional roles. [file:31]

### J1 – 24 V Power Input

- VIN (24 V nominal) passes through F1 and protection diodes D1/D2 to form the 24Va/24Vs rails. [file:31]  
- GND connects to the board ground, shared with MOSFET source nodes and PLC 0 V returns. [file:31]

### J3–J8 – Digital Field Inputs (I1, I2, I3, I5, I6, I7)

Each connector provides a 24 V input channel plus a dedicated 0 V return for a PLC input. [file:31]

- Field input pin: goes through a series diode (D8–D13) and resistor (R11–R16) into a PLC input pin on U1 (pins 5–11). [file:31]  
- 0 V return: matches a specific 0 V node (e.g., I1_0V, I2_0V, etc.) and ties back to system GND. [file:31]  
- Pulldown resistors R17–R22 provide defined off‑state behavior for the PLC inputs. [file:31]

### J9–J13 – Line Outputs (Low‑Side Driven Loads)

Each connector is associated with one MOSFET driver Q1–Q5. [file:31]

- Pin 1: 24Va high side supply for the load. [file:31]  
- Pin 2: Switched low side (Qx_SW), which is the MOSFET drain node (Qx:D) and the load return. [file:31]  
- Each MOSFET source (Qx:S) connects to GND and Qx_0V net. [file:31]  
- Flyback diode Dx clamps Qx_SW to Qx_0V to protect against inductive kick when switching off inductive loads. [file:31]

### J15 – Color Sensor Connector

- 9 V supply and GND rails provided for the external color sensor module. [file:31]  
- SENS_SIG returned to the board, buffered by op‑amp U3, and routed to PLC analog input node PLC_I4_AIN. [file:31]

(Add exact pin numbering and orientation once you finalize the schematic annotation.)

---

## 6. PCB Manufacturing Notes

(To be completed with actual mechanical data.)

- Board size: `WIDTH × HEIGHT mm`  
- Layers: `N` layers  
- Material/thickness: e.g., FR‑4, 1.6 mm  
- Copper weight: e.g., 1 oz outer, 1 oz inner  
- Finish: ENIG / HASL  
- Mask/silkscreen: colors and sides  
- Special requirements: appropriate creepage/clearance for 24 V, mounting holes, slots, etc.

---

## 7. Assembly Information

- **BOM:** Contains F1, D1–D13, U1, U2, U3, Q1–Q5, L1, C1, C4, C8, feedback and gate resistors, and connectors J1–J15. [file:31]  
- **Polarity/orientation:**  
  - Diodes D1–D13, MOSFETs Q1–Q5, and electrolytic capacitors must be oriented correctly. [file:31]  
  - ICs U1, U2, U3 must align with their pin‑1 indicators. [file:31]  
- **Assembly order:** Recommended to populate small SMD parts first (resistors, diodes, ICs), then larger components and connectors (L1, terminals Jx, fuse F1). [file:31]

---

## 8. Functional Description

- **Power stage:** 24 V input is fused and protected before feeding 24Va/24Vs; TPS54302 buck converts 24Vs to 9 V, and an LDO produces 5V_AUX for analog circuitry. [file:31]  
- **Digital inputs:** Field 24 V inputs are diode‑ and resistor‑limited before the PLC, with pulldowns to ensure defined off levels. [file:31]  
- **Output drivers:** PLC outputs drive MOSFET gates via series resistors R1–R5, with gate pulldowns R6–R10; MOSFET drains switch the load low side at J9–J13, and diodes D3–D7 provide flyback protection. [file:31]  
- **Analog sensor path:** A color sensor on J15 is powered from 9 V and GND, with its signal buffered by U3 and sent to PLC analog input PLC_I4_AIN. [file:31]

---

## 9. Testing and Bring‑Up

- Verify no short between 24 V and GND at J1 before powering.  
- Power up with a current‑limited 24 V supply and confirm the presence of 9 V and 5V_AUX rails. [file:31]  
- Check PLC input channels by applying known 24 V signals to J3–J8 and observing corresponding PLC inputs. [file:31]  
- Test each line output by connecting a dummy load (e.g., lamp or resistor) on J9–J13 and toggling the corresponding PLC output, watching for correct switching and absence of over‑current or overheating. [file:31]

---

## 10. Tools and License

- **CAD tool:** Flux (project URL above).  

